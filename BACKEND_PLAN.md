# –ü–õ–ê–ù –†–ï–ê–õ–ò–ó–ê–¶–ò–ò –ë–≠–ö–ï–ù–î–ê MechanicCompanion

## –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

–ë—ç–∫–µ–Ω–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ React Native –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è MechanicCompanion - —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–æ–º –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ–≤–æ—Ä—è—â–∏—Ö –∞–≤—Ç–æ–º–µ—Ö–∞–Ω–∏–∫–æ–≤, –¥–µ—Ç–µ–π–ª–µ—Ä–æ–≤ –∏ –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–æ–≤.

**–ö–ª–∏–µ–Ω—Ç—Å–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: `/Users/akozlov/projects/MechanicCompanion`

---

## üìä –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–° –ü–†–û–ï–ö–¢–ê

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 04 —Ñ–µ–≤—Ä–∞–ª—è 2026 (20:35)

### ‚úÖ –§–∞–∑–∞ 1: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –±–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ - –ó–ê–í–ï–†–®–ï–ù–ê

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω NestJS –ø—Ä–æ–µ–∫—Ç —Å TypeScript
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (Prisma 6.19.2, NestJS 11, JWT, Passport, Sharp, Puppeteer, –∏ —Ç.–¥.)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã ESLint, Prettier, TypeScript
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è Prisma —Å—Ö–µ–º–∞ –ë–î (11 –º–æ–¥–µ–ª–µ–π: User, Car, Visit, RefreshToken, PasswordResetToken –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ)
- ‚úÖ –°–æ–∑–¥–∞–Ω PrismaModule –∏ PrismaService
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (ConfigModule, .env, configuration.ts)
- ‚úÖ –°–æ–∑–¥–∞–Ω Dockerfile (multi-stage build) –∏ docker-compose.yml
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã .gitignore –∏ .dockerignore
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è uploads –∏ temp —Ñ–∞–π–ª–æ–≤
- ‚úÖ –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –≥–æ—Ç–æ–≤–∞

### ‚úÖ –§–∞–∑–∞ 2: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å - –ó–ê–í–ï–†–®–ï–ù–ê

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω Auth –º–æ–¥—É–ª—å —Å–æ –≤—Å–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π (dto, guards, strategies, decorators)
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤—Å–µ DTOs —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π (register, login, refresh, forgot/reset password)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã JWT —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ (access token 1h, refresh token 7d)
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã Guards (JwtAuthGuard, JwtRefreshGuard)
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä @CurrentUser –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ AuthService —Å –ø–æ–ª–Ω–æ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π:
  - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å bcrypt —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º (10 rounds)
  - –õ–æ–≥–∏–Ω —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π credentials
  - Refresh token rotation (—Å—Ç–∞—Ä—ã–π —É–¥–∞–ª—è–µ—Ç—Å—è, —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π)
  - Forgot password —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π —Ç–æ–∫–µ–Ω–∞ (–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 1 —á–∞—Å)
  - Reset password —Å –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –≤—Å–µ—Ö refresh tokens
- ‚úÖ AuthController —Å endpoints:
  - `POST /api/auth/register`
  - `POST /api/auth/login`
  - `POST /api/auth/refresh`
  - `POST /api/auth/forgot-password`
  - `POST /api/auth/reset-password`
  - `GET /api/auth/me` (–∑–∞—â–∏—â–µ–Ω JWT)
- ‚úÖ HttpExceptionFilter –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- ‚úÖ TransformInterceptor –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤ API
- ‚úÖ Rate limiting: register/login (5/–º–∏–Ω), forgot password (3/–º–∏–Ω), –æ–±—â–µ–µ (100/–º–∏–Ω)
- ‚úÖ –í—Å–µ endpoints –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã (–ø–æ–∑–∏—Ç–∏–≤–Ω—ã–µ –∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:**
```
MechanicCompanionBackend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ auth/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dto/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ register.dto.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login.dto.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ refresh-token.dto.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ forgot-password.dto.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ reset-password.dto.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ guards/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ jwt-auth.guard.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ jwt-refresh.guard.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ strategies/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ jwt.strategy.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ jwt-refresh.strategy.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ decorators/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ current-user.decorator.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.controller.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.service.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ auth.module.ts
‚îÇ   ‚îú‚îÄ‚îÄ common/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ filters/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ http-exception.filter.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ interceptors/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ transform.interceptor.ts
‚îÇ   ‚îú‚îÄ‚îÄ config/          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (configuration.ts, file-upload.config.ts)
‚îÇ   ‚îú‚îÄ‚îÄ prisma/          # Prisma –º–æ–¥—É–ª—å –∏ —Å–µ—Ä–≤–∏—Å
‚îÇ   ‚îú‚îÄ‚îÄ app.module.ts    # –ì–ª–∞–≤–Ω—ã–π –º–æ–¥—É–ª—å (ConfigModule, PrismaModule, ThrottlerModule, AuthModule)
‚îÇ   ‚îú‚îÄ‚îÄ app.controller.ts
‚îÇ   ‚îú‚îÄ‚îÄ app.service.ts
‚îÇ   ‚îî‚îÄ‚îÄ main.ts          # Entry point —Å security, filters, interceptors
‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îî‚îÄ‚îÄ schema.prisma    # –ü–æ–ª–Ω–∞—è —Å—Ö–µ–º–∞ –ë–î —Å 11 –º–æ–¥–µ–ª—è–º–∏
‚îú‚îÄ‚îÄ .env / .env.example
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ CLAUDE.md            # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è Claude Code
‚îî‚îÄ‚îÄ package.json
```

**–í–µ—Ä—Å–∏–∏ –ø–∞–∫–µ—Ç–æ–≤:**
- NestJS: 11.1.13
- Prisma: 6.19.2
- TypeScript: 5.9.3
- Node: 20 (Alpine –¥–ª—è Docker)
- bcrypt: 6.0.0
- passport-jwt: 4.0.1

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –§–∞–∑–∞ 3 - –ú–æ–¥—É–ª—å –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π (Cars)

---

## –í—ã–±—Ä–∞–Ω–Ω—ã–π —Å—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- **Framework**: NestJS
- **Database**: PostgreSQL 16
- **ORM**: Prisma
- **Auth**: JWT + Refresh Token
- **File Storage**: –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- **Email**: SMTP (Nodemailer)
- **PDF Generation**: Puppeteer
- **Containerization**: Docker + Docker Compose
- **Language**: TypeScript

---

## –û—Å–Ω–æ–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏–∑ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

**User (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)**
```typescript
{
  id: string;
  email: string;
  workshopName?: string;      // –ù–∞–∑–≤–∞–Ω–∏–µ –º–∞—Å—Ç–µ—Ä—Å–∫–æ–π
  phone?: string;
  address?: string;
  logoUrl?: string;           // –õ–æ–≥–æ—Ç–∏–ø
  signatureUrl?: string;      // –ü–æ–¥–ø–∏—Å—å –¥–ª—è PDF
  createdAt: string;
  updatedAt: string;
}
```

**Car (–ê–≤—Ç–æ–º–æ–±–∏–ª—å)**
```typescript
{
  id: string;
  userId: string;
  licensePlate: string;       // –ì–æ—Å–Ω–æ–º–µ—Ä (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π)
  brand: string;              // –ú–∞—Ä–∫–∞
  model: string;              // –ú–æ–¥–µ–ª—å
  year?: number;              // –ì–æ–¥ –≤—ã–ø—É—Å–∫–∞
  vin?: string;               // VIN-–Ω–æ–º–µ—Ä
  ownerName?: string;         // –í–ª–∞–¥–µ–ª–µ—Ü (–§–ò–û)
  ownerPhone?: string;        // –¢–µ–ª–µ—Ñ–æ–Ω
  ownerEmail?: string;        // Email
  mainPhotoUrl?: string;      // –ì–ª–∞–≤–Ω–æ–µ —Ñ–æ—Ç–æ
  photos?: CarPhoto[];        // –î–æ 3 —Ñ–æ—Ç–æ
  notes?: string;             // –ó–∞–º–µ—Ç–∫–∏
  lastVisitDate?: string;     // –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–∏–∑–∏—Ç–∞
  visitsCount: number;        // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∏–∑–∏—Ç–æ–≤
  createdAt: string;
  updatedAt: string;
}
```

**Visit (–í–∏–∑–∏—Ç/–ó–∞–∫–∞–∑)**
```typescript
{
  id: string;
  carId: string;
  car?: Car;
  visitDate: string;
  workType: WorkType;         // –¢–∏–ø —Ä–∞–±–æ—Ç (enum)
  workDescription: string;
  estimatedCost?: number;     // –ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å
  finalCost?: number;         // –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å
  estimatedCompletionDate?: string;
  status: VisitStatus;        // –°—Ç–∞—Ç—É—Å (enum)

  // –ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–∏—ë–º–∫–∏
  fuelLevel?: number;         // 0-100%
  mileage?: number;           // –ü—Ä–æ–±–µ–≥
  hasDamages: boolean;
  damagesDescription?: string;
  personalItems?: string;     // –õ–∏—á–Ω—ã–µ –≤–µ—â–∏
  tireCondition?: string;     // –°–æ—Å—Ç–æ—è–Ω–∏–µ —à–∏–Ω

  photos?: VisitPhoto[];      // –§–æ—Ç–æ –î–û/–ü–û–°–õ–ï
  materials?: VisitMaterial[]; // –ú–∞—Ç–µ—Ä–∏–∞–ª—ã
  documents?: VisitDocument[]; // –î–æ–∫—É–º–µ–Ω—Ç—ã
  createdAt: string;
  updatedAt: string;
}
```

**VisitMaterial (–ú–∞—Ç–µ—Ä–∏–∞–ª—ã/–∑–∞–ø—á–∞—Å—Ç–∏)**
```typescript
{
  id: string;
  visitId: string;
  name: string;               // –ù–∞–∑–≤–∞–Ω–∏–µ
  quantity: number;           // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ
  price: number;              // –¶–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É
  createdAt: string;
}
```

**Enum —Ç–∏–ø—ã**
```typescript
enum WorkType {
  DETAILING = 'detailing',
  MAINTENANCE = 'maintenance',
  REPAIR = 'repair',
  DIAGNOSTICS = 'diagnostics',
  TIRE_SERVICE = 'tire_service',
  OTHER = 'other',
}

enum VisitStatus {
  IN_PROGRESS = 'in_progress',
  COMPLETED = 'completed',
  DELIVERED = 'delivered',
  CANCELLED = 'cancelled',
}

enum PhotoType {
  BEFORE = 'before',
  AFTER = 'after',
}
```

### –û–∂–∏–¥–∞–µ–º—ã–µ API Endpoints

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:**
- `POST /api/auth/register` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `POST /api/auth/login` - –≤—Ö–æ–¥
- `POST /api/auth/refresh` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
- `POST /api/auth/forgot-password` - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è
- `POST /api/auth/reset-password` - —Å–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è
- `GET /api/auth/me` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ê–≤—Ç–æ–º–æ–±–∏–ª–∏:**
- `GET /api/cars` - —Å–ø–∏—Å–æ–∫ (—Å query params: search, sortBy)
- `POST /api/cars` - —Å–æ–∑–¥–∞–Ω–∏–µ
- `GET /api/cars/:id` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ ID
- `PUT /api/cars/:id` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- `DELETE /api/cars/:id` - —É–¥–∞–ª–µ–Ω–∏–µ
- `POST /api/cars/:id/photos` - –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ

**–í–∏–∑–∏—Ç—ã:**
- `GET /api/cars/:carId/visits` - –≤–∏–∑–∏—Ç—ã –∞–≤—Ç–æ–º–æ–±–∏–ª—è
- `GET /api/visits` - –≤—Å–µ –≤–∏–∑–∏—Ç—ã (—Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π)
- `POST /api/visits` - —Å–æ–∑–¥–∞–Ω–∏–µ
- `GET /api/visits/:id` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ ID
- `PUT /api/visits/:id` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- `DELETE /api/visits/:id` - —É–¥–∞–ª–µ–Ω–∏–µ
- `PATCH /api/visits/:id/status` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
- `POST /api/visits/:id/photos` - –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ
- `POST /api/visits/:id/documents` - –∑–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- `DELETE /api/visits/:id/documents/:docId` - —É–¥–∞–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `GET /api/visits/:id/export-pdf` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è PDF
- `POST /api/visits/:id/send-report` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á—ë—Ç–∞ –Ω–∞ email

**–ú–∞—Ç–µ—Ä–∏–∞–ª—ã –≤–∏–∑–∏—Ç–∞:**
- `GET /api/visits/:visitId/materials` - —Å–ø–∏—Å–æ–∫ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
- `POST /api/visits/:visitId/materials` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ
- `PUT /api/materials/:id` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- `DELETE /api/materials/:id` - —É–¥–∞–ª–µ–Ω–∏–µ

**–î–æ–∫—É–º–µ–Ω—Ç—ã –∞–≤—Ç–æ–º–æ–±–∏–ª—è:**
- `GET /api/cars/:carId/documents` - —Å–ø–∏—Å–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- `POST /api/cars/:carId/documents` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ
- `DELETE /api/documents/:id` - —É–¥–∞–ª–µ–Ω–∏–µ

**–ü—Ä–æ—Ñ–∏–ª—å:**
- `GET /api/profile` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- `PUT /api/profile` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- `PUT /api/profile/password` - —Å–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è
- `POST /api/profile/logo` - –∑–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ—Ç–∏–ø–∞
- `POST /api/profile/signature` - –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ–¥–ø–∏—Å–∏

**–§–∞–π–ª—ã:**
- `POST /api/upload` - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π endpoint –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
- `GET /api/files/*` - —Ä–∞–∑–¥–∞—á–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤

### –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤ API

–í—Å–µ –æ—Ç–≤–µ—Ç—ã –¥–æ–ª–∂–Ω—ã —Å–ª–µ–¥–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É:
```typescript
{
  data: T,              // –î–∞–Ω–Ω—ã–µ (–æ–±—ä–µ–∫—Ç –∏–ª–∏ –º–∞—Å—Å–∏–≤)
  message?: string,     // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
  success: boolean      // –°—Ç–∞—Ç—É—Å –æ–ø–µ—Ä–∞—Ü–∏–∏
}
```

---

## –§–ê–ó–´ –†–ê–ó–†–ê–ë–û–¢–ö–ò

### –§–∞–∑–∞ 1: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –±–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (2-3 —á–∞—Å–∞)

#### 1.1 –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ NestJS –ø—Ä–æ–µ–∫—Ç–∞ —Å TypeScript
  ```bash
  npm i -g @nestjs/cli
  nest new MechanicCompanionBackend
  ```
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ESLint, Prettier
- [ ] –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–º–æ–¥—É–ª–∏: auth, cars, visits, materials, documents, profile, files, mail, pdf)
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env, @nestjs/config)
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
  ```bash
  npm install @nestjs/config @nestjs/jwt @nestjs/passport passport passport-jwt bcrypt
  npm install @prisma/client
  npm install -D prisma
  npm install class-validator class-transformer
  npm install @nestjs/platform-express multer
  npm install sharp # –¥–ª—è —Å–∂–∞—Ç–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  npm install nodemailer @nestjs-modules/mailer handlebars
  npm install puppeteer
  npm install @nestjs/throttler # rate limiting
  npm install helmet compression
  ```

#### 1.2 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL –∏ Prisma
- [ ] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Prisma
  ```bash
  npx prisma init
  ```
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ schema.prisma —Å –º–æ–¥–µ–ª—è–º–∏:

```prisma
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id            String    @id @default(uuid())
  email         String    @unique
  password      String
  workshopName  String?   @map("workshop_name")
  phone         String?
  address       String?
  logoUrl       String?   @map("logo_url")
  signatureUrl  String?   @map("signature_url")
  createdAt     DateTime  @default(now()) @map("created_at")
  updatedAt     DateTime  @updatedAt @map("updated_at")

  cars          Car[]
  refreshTokens RefreshToken[]

  @@map("users")
}

model RefreshToken {
  id        String   @id @default(uuid())
  userId    String   @map("user_id")
  token     String   @unique
  expiresAt DateTime @map("expires_at")
  createdAt DateTime @default(now()) @map("created_at")

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("refresh_tokens")
  @@index([userId])
}

model Car {
  id             String    @id @default(uuid())
  userId         String    @map("user_id")
  licensePlate   String    @map("license_plate")
  brand          String
  model          String
  year           Int?
  vin            String?
  ownerName      String?   @map("owner_name")
  ownerPhone     String?   @map("owner_phone")
  ownerEmail     String?   @map("owner_email")
  mainPhotoUrl   String?   @map("main_photo_url")
  notes          String?
  lastVisitDate  DateTime? @map("last_visit_date")
  visitsCount    Int       @default(0) @map("visits_count")
  createdAt      DateTime  @default(now()) @map("created_at")
  updatedAt      DateTime  @updatedAt @map("updated_at")

  user      User          @relation(fields: [userId], references: [id], onDelete: Cascade)
  photos    CarPhoto[]
  documents CarDocument[]
  visits    Visit[]

  @@unique([userId, licensePlate])
  @@map("cars")
  @@index([userId])
  @@index([licensePlate])
}

model CarPhoto {
  id        String   @id @default(uuid())
  carId     String   @map("car_id")
  photoUrl  String   @map("photo_url")
  createdAt DateTime @default(now()) @map("created_at")

  car Car @relation(fields: [carId], references: [id], onDelete: Cascade)

  @@map("car_photos")
  @@index([carId])
}

model CarDocument {
  id           String   @id @default(uuid())
  carId        String   @map("car_id")
  documentUrl  String   @map("document_url")
  documentName String   @map("document_name")
  createdAt    DateTime @default(now()) @map("created_at")

  car Car @relation(fields: [carId], references: [id], onDelete: Cascade)

  @@map("car_documents")
  @@index([carId])
}

enum WorkType {
  DETAILING
  MAINTENANCE
  REPAIR
  DIAGNOSTICS
  TIRE_SERVICE
  OTHER
}

enum VisitStatus {
  IN_PROGRESS
  COMPLETED
  DELIVERED
  CANCELLED
}

model Visit {
  id                      String       @id @default(uuid())
  carId                   String       @map("car_id")
  visitDate               DateTime     @map("visit_date")
  workType                WorkType     @map("work_type")
  workDescription         String       @map("work_description")
  estimatedCost           Decimal?     @map("estimated_cost") @db.Decimal(10, 2)
  finalCost               Decimal?     @map("final_cost") @db.Decimal(10, 2)
  estimatedCompletionDate DateTime?    @map("estimated_completion_date")
  status                  VisitStatus  @default(IN_PROGRESS)
  fuelLevel               Int?         @map("fuel_level")
  mileage                 Int?
  hasDamages              Boolean      @default(false) @map("has_damages")
  damagesDescription      String?      @map("damages_description")
  personalItems           String?      @map("personal_items")
  tireCondition           String?      @map("tire_condition")
  createdAt               DateTime     @default(now()) @map("created_at")
  updatedAt               DateTime     @updatedAt @map("updated_at")

  car       Car              @relation(fields: [carId], references: [id], onDelete: Cascade)
  photos    VisitPhoto[]
  materials VisitMaterial[]
  documents VisitDocument[]

  @@map("visits")
  @@index([carId])
  @@index([status])
}

enum PhotoType {
  BEFORE
  AFTER
}

model VisitPhoto {
  id        String    @id @default(uuid())
  visitId   String    @map("visit_id")
  photoUrl  String    @map("photo_url")
  photoType PhotoType @map("photo_type")
  createdAt DateTime  @default(now()) @map("created_at")

  visit Visit @relation(fields: [visitId], references: [id], onDelete: Cascade)

  @@map("visit_photos")
  @@index([visitId])
}

model VisitMaterial {
  id        String   @id @default(uuid())
  visitId   String   @map("visit_id")
  name      String
  quantity  Decimal  @db.Decimal(10, 2)
  price     Decimal  @db.Decimal(10, 2)
  createdAt DateTime @default(now()) @map("created_at")

  visit Visit @relation(fields: [visitId], references: [id], onDelete: Cascade)

  @@map("visit_materials")
  @@index([visitId])
}

model VisitDocument {
  id           String   @id @default(uuid())
  visitId      String   @map("visit_id")
  documentUrl  String   @map("document_url")
  documentName String   @map("document_name")
  createdAt    DateTime @default(now()) @map("created_at")

  visit Visit @relation(fields: [visitId], references: [id], onDelete: Cascade)

  @@map("visit_documents")
  @@index([visitId])
}
```

- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
  ```bash
  npx prisma migrate dev --name init
  ```
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ seed.ts –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ PrismaModule –∏ PrismaService

#### 1.3 Docker –∏ Docker Compose
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ Dockerfile (multi-stage build)
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ docker-compose.yml —Å —Å–µ—Ä–≤–∏—Å–∞–º–∏ postgres –∏ app
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ volumes –¥–ª—è PostgreSQL –∏ uploads
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ .dockerignore
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞ —á–µ—Ä–µ–∑ docker-compose

---

### –§–∞–∑–∞ 2: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (3-4 —á–∞—Å–∞)

#### 2.1 Auth Module

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
src/auth/
‚îú‚îÄ‚îÄ auth.controller.ts
‚îú‚îÄ‚îÄ auth.service.ts
‚îú‚îÄ‚îÄ auth.module.ts
‚îú‚îÄ‚îÄ dto/
‚îÇ   ‚îú‚îÄ‚îÄ register.dto.ts
‚îÇ   ‚îú‚îÄ‚îÄ login.dto.ts
‚îÇ   ‚îú‚îÄ‚îÄ refresh-token.dto.ts
‚îÇ   ‚îú‚îÄ‚îÄ forgot-password.dto.ts
‚îÇ   ‚îî‚îÄ‚îÄ reset-password.dto.ts
‚îú‚îÄ‚îÄ guards/
‚îÇ   ‚îú‚îÄ‚îÄ jwt-auth.guard.ts
‚îÇ   ‚îî‚îÄ‚îÄ jwt-refresh.guard.ts
‚îú‚îÄ‚îÄ strategies/
‚îÇ   ‚îú‚îÄ‚îÄ jwt.strategy.ts
‚îÇ   ‚îî‚îÄ‚îÄ jwt-refresh.strategy.ts
‚îî‚îÄ‚îÄ decorators/
    ‚îî‚îÄ‚îÄ current-user.decorator.ts
```

**Endpoints:**
- [ ] `POST /api/auth/register` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
  - –í–∞–ª–∏–¥–∞—Ü–∏—è email —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
  - –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è (bcrypt, rounds: 10)
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è JWT access token (expires: 1h)
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è refresh token (expires: 7d)
  - –í–æ–∑–≤—Ä–∞—Ç `{ token, refreshToken, user }`

- [ ] `POST /api/auth/login` - –≤—Ö–æ–¥
  - –í–∞–ª–∏–¥–∞—Ü–∏—è credentials
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è access + refresh tokens
  - –í–æ–∑–≤—Ä–∞—Ç `{ token, refreshToken, user }`

- [ ] `POST /api/auth/refresh` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
  - –í–∞–ª–∏–¥–∞—Ü–∏—è refresh token –∏–∑ –ë–î
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ access token
  - –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: rotation refresh token
  - –í–æ–∑–≤—Ä–∞—Ç `{ token, refreshToken }`

- [ ] `POST /api/auth/forgot-password` - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è reset token (UUID)
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î —Å expiration (1 —á–∞—Å)
  - –û—Ç–ø—Ä–∞–≤–∫–∞ email —Å —Å—Å—ã–ª–∫–æ–π
  - –í–æ–∑–≤—Ä–∞—Ç `{ success: true, message: 'Email –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω' }`

- [ ] `POST /api/auth/reset-password` - —Å–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è
  - –í–∞–ª–∏–¥–∞—Ü–∏—è reset token
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è
  - –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è reset token
  - –í–æ–∑–≤—Ä–∞—Ç `{ success: true }`

- [ ] `GET /api/auth/me` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - –ó–∞—â–∏—â–µ–Ω–æ JwtAuthGuard
  - –í–æ–∑–≤—Ä–∞—Ç user –±–µ–∑ password

#### 2.2 Guards –∏ Middleware
- [ ] JwtAuthGuard - –ø—Ä–æ–≤–µ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω–∞ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization
- [ ] JwtRefreshGuard - –ø—Ä–æ–≤–µ—Ä–∫–∞ refresh token
- [ ] JwtStrategy - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ user –∏–∑ —Ç–æ–∫–µ–Ω–∞
- [ ] ValidationPipe - –≥–ª–æ–±–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è DTO (whitelist: true, transform: true)
- [ ] ExceptionFilter - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- [ ] TransformInterceptor - —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç `{ data, message, success }`
- [ ] CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (origin: '*' –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–æ–º–µ–Ω—ã –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

#### 2.3 –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è reset tokens
```prisma
model PasswordResetToken {
  id        String   @id @default(uuid())
  userId    String   @map("user_id")
  token     String   @unique
  expiresAt DateTime @map("expires_at")
  used      Boolean  @default(false)
  createdAt DateTime @default(now()) @map("created_at")

  @@map("password_reset_tokens")
  @@index([userId])
  @@index([token])
}
```

---

### –§–∞–∑–∞ 3: –ú–æ–¥—É–ª—å –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π (Cars) (2-3 —á–∞—Å–∞)

#### 3.1 Cars Module

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
src/cars/
‚îú‚îÄ‚îÄ cars.controller.ts
‚îú‚îÄ‚îÄ cars.service.ts
‚îú‚îÄ‚îÄ cars.module.ts
‚îî‚îÄ‚îÄ dto/
    ‚îú‚îÄ‚îÄ create-car.dto.ts
    ‚îú‚îÄ‚îÄ update-car.dto.ts
    ‚îî‚îÄ‚îÄ query-cars.dto.ts
```

**Endpoints:**
- [ ] `GET /api/cars` - —Å–ø–∏—Å–æ–∫ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π
  - Query params:
    - `search` (–ø–æ –≥–æ—Å–Ω–æ–º–µ—Ä—É, –º–∞—Ä–∫–µ, –º–æ–¥–µ–ª–∏, –≤–ª–∞–¥–µ–ª—å—Ü—É)
    - `sortBy` (date | brand, default: date)
  - –§–∏–ª—å—Ç—Ä –ø–æ userId —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - –í–∫–ª—é—á–∞–µ—Ç visitsCount, lastVisitDate
  - –ü–∞–≥–∏–Ω–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è MVP)

- [ ] `POST /api/cars` - —Å–æ–∑–¥–∞–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π: licensePlate, brand, model, ownerName, ownerPhone
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –≥–æ—Å–Ω–æ–º–µ—Ä–∞ –≤ —Ä–∞–º–∫–∞—Ö userId
  - –í–∞–ª–∏–¥–∞—Ü–∏—è VIN (17 —Å–∏–º–≤–æ–ª–æ–≤, –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω)
  - –í–∞–ª–∏–¥–∞—Ü–∏—è email (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω)
  - –í–æ–∑–≤—Ä–∞—Ç —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è

- [ ] `GET /api/cars/:id` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (car.userId === currentUser.id)
  - –í–∫–ª—é—á–∞–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: photos, documents, visits

- [ ] `PUT /api/cars/:id` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –≥–æ—Å–Ω–æ–º–µ—Ä–∞ –Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å
  - –í–æ–∑–≤—Ä–∞—Ç –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è

- [ ] `DELETE /api/cars/:id` - —É–¥–∞–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
  - –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (Prisma onDelete: Cascade)
  - –§–∏–∑–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ —Ñ–æ—Ç–æ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
  - –í–æ–∑–≤—Ä–∞—Ç `{ success: true }`

- [ ] `POST /api/cars/:id/photos` - –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ (–¥–æ 3 —à—Ç)
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
  - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ (JPEG/PNG)
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ (–º–∞–∫—Å–∏–º—É–º 3 —Ñ–æ—Ç–æ)
  - –°–∂–∞—Ç–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (sharp: max 1920x1080, quality 80%)
  - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ mainPhotoUrl –µ—Å–ª–∏ –ø–µ—Ä–≤–æ–µ —Ñ–æ—Ç–æ
  - –í–æ–∑–≤—Ä–∞—Ç –º–∞—Å—Å–∏–≤–∞ URL –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ

#### 3.2 Car Documents
- [ ] `GET /api/cars/:carId/documents` - —Å–ø–∏—Å–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

- [ ] `POST /api/cars/:carId/documents` - –∑–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
  - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ (PDF/DOC/DOCX)
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∏–º–µ–Ω–µ–º
  - –í–æ–∑–≤—Ä–∞—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å URL

- [ ] `DELETE /api/documents/:id` - —É–¥–∞–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (—á–µ—Ä–µ–∑ car -> user)
  - –§–∏–∑–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
  - –í–æ–∑–≤—Ä–∞—Ç `{ success: true }`

#### 3.3 –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- [ ] –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—è: —É—Å—Ç–∞–Ω–æ–≤–∫–∞ visitsCount = 0
- [ ] –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—è: —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è VIN: 17 —Å–∏–º–≤–æ–ª–æ–≤, –ª–∞—Ç–∏–Ω–∏—Ü–∞ –∏ —Ü–∏—Ñ—Ä—ã
- [ ] –ü–æ–∏—Å–∫: case-insensitive, –ø–æ —á–∞—Å—Ç–∏—á–Ω–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é

---

### –§–∞–∑–∞ 4: –ú–æ–¥—É–ª—å –≤–∏–∑–∏—Ç–æ–≤ (Visits) (3-4 —á–∞—Å–∞)

#### 4.1 Visits Module

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
src/visits/
‚îú‚îÄ‚îÄ visits.controller.ts
‚îú‚îÄ‚îÄ visits.service.ts
‚îú‚îÄ‚îÄ visits.module.ts
‚îî‚îÄ‚îÄ dto/
    ‚îú‚îÄ‚îÄ create-visit.dto.ts
    ‚îú‚îÄ‚îÄ update-visit.dto.ts
    ‚îú‚îÄ‚îÄ update-status.dto.ts
    ‚îî‚îÄ‚îÄ query-visits.dto.ts
```

**Endpoints:**
- [ ] `GET /api/visits` - –≤—Å–µ –≤–∏–∑–∏—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - Query params:
    - `carId` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—é
    - `status` - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É
    - `dateFrom`, `dateTo` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –¥–∞—Ç–∞–º
  - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ visitDate DESC
  - –í–∫–ª—é—á–∞–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: car, materials, photos

- [ ] `GET /api/cars/:carId/visits` - –≤–∏–∑–∏—Ç—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
  - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ visitDate DESC

- [ ] `POST /api/visits` - —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑–∏—Ç–∞
  - –í–∞–ª–∏–¥–∞—Ü–∏—è carId –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å—Ç–∞—Ç—É—Å "IN_PROGRESS"
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ lastVisitDate –∏ visitsCount —É –∞–≤—Ç–æ–º–æ–±–∏–ª—è
  - –í–æ–∑–≤—Ä–∞—Ç —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –≤–∏–∑–∏—Ç–∞ —Å car

- [ ] `GET /api/visits/:id` - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤–∏–∑–∏—Ç–∞
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (—á–µ—Ä–µ–∑ car -> user)
  - –í–∫–ª—é—á–∞–µ—Ç: car, materials, photos, documents

- [ ] `PUT /api/visits/:id` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∏–∑–∏—Ç–∞
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ lastVisitDate —É –∞–≤—Ç–æ–º–æ–±–∏–ª—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞—Ç—ã
  - –í–æ–∑–≤—Ä–∞—Ç –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–≥–æ –≤–∏–∑–∏—Ç–∞

- [ ] `DELETE /api/visits/:id` - —É–¥–∞–ª–µ–Ω–∏–µ –≤–∏–∑–∏—Ç–∞
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
  - –ü–µ—Ä–µ—Å—á—ë—Ç visitsCount —É –∞–≤—Ç–æ–º–æ–±–∏–ª—è
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ lastVisitDate (–∏–∑ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –≤–∏–∑–∏—Ç–æ–≤)
  - –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ materials, photos, documents
  - –§–∏–∑–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
  - –í–æ–∑–≤—Ä–∞—Ç `{ success: true }`

- [ ] `PATCH /api/visits/:id/status` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
  - –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–∞ (IN_PROGRESS, COMPLETED, DELIVERED, CANCELLED)
  - –í–æ–∑–≤—Ä–∞—Ç –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–≥–æ –≤–∏–∑–∏—Ç–∞

- [ ] `POST /api/visits/:id/photos` - –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ (–¥–æ 10 —à—Ç)
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
  - Body: `{ type: 'before' | 'after', files: File[] }`
  - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –∏ —Ä–∞–∑–º–µ—Ä–∞
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ (–º–∞–∫—Å–∏–º—É–º 10 —Ñ–æ—Ç–æ)
  - –°–∂–∞—Ç–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  - –í–æ–∑–≤—Ä–∞—Ç –º–∞—Å—Å–∏–≤–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ

#### 4.2 Visit Materials Module

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
src/materials/
‚îú‚îÄ‚îÄ materials.controller.ts
‚îú‚îÄ‚îÄ materials.service.ts
‚îú‚îÄ‚îÄ materials.module.ts
‚îî‚îÄ‚îÄ dto/
    ‚îú‚îÄ‚îÄ create-material.dto.ts
    ‚îî‚îÄ‚îÄ update-material.dto.ts
```

**Endpoints:**
- [ ] `GET /api/visits/:visitId/materials` - —Å–ø–∏—Å–æ–∫ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

- [ ] `POST /api/visits/:visitId/materials` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
  - –ü–æ–ª—è: name, quantity, price
  - –í–∞–ª–∏–¥–∞—Ü–∏—è: quantity > 0, price >= 0
  - –í–æ–∑–≤—Ä–∞—Ç —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞

- [ ] `PUT /api/materials/:id` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (—á–µ—Ä–µ–∑ visit -> car -> user)
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π
  - –í–æ–∑–≤—Ä–∞—Ç –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞

- [ ] `DELETE /api/materials/:id` - —É–¥–∞–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
  - –í–æ–∑–≤—Ä–∞—Ç `{ success: true }`

#### 4.3 Visit Documents
- [ ] `GET /api/visits/:visitId/documents` - —Å–ø–∏—Å–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- [ ] `POST /api/visits/:visitId/documents` - –∑–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- [ ] `DELETE /api/documents/:id` - —É–¥–∞–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (–æ–±—â–∏–π —Å car documents)

#### 4.4 –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- [ ] –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≤–∏–∑–∏—Ç–∞:
  - –£–≤–µ–ª–∏—á–µ–Ω–∏–µ visitsCount —É –∞–≤—Ç–æ–º–æ–±–∏–ª—è
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ lastVisitDate —É –∞–≤—Ç–æ–º–æ–±–∏–ª—è

- [ ] –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –≤–∏–∑–∏—Ç–∞:
  - –£–º–µ–Ω—å—à–µ–Ω–∏–µ visitsCount —É –∞–≤—Ç–æ–º–æ–±–∏–ª—è
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ lastVisitDate (–≤–∑—è—Ç—å –¥–∞—Ç—É –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ—Å—Ç–∞–≤—à–µ–≥–æ—Å—è –≤–∏–∑–∏—Ç–∞)

- [ ] –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞—Ç—ã –≤–∏–∑–∏—Ç–∞:
  - –ü–µ—Ä–µ—Å—á—ë—Ç lastVisitDate —É –∞–≤—Ç–æ–º–æ–±–∏–ª—è (–µ—Å–ª–∏ —ç—Ç–æ —Å–∞–º—ã–π –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–∏–∑–∏—Ç)

---

### –§–∞–∑–∞ 5: –§–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (1-2 —á–∞—Å–∞)

#### 5.1 Files Module

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
src/files/
‚îú‚îÄ‚îÄ files.controller.ts
‚îú‚îÄ‚îÄ files.service.ts
‚îú‚îÄ‚îÄ files.module.ts
‚îî‚îÄ‚îÄ interceptors/
    ‚îî‚îÄ‚îÄ file-upload.interceptor.ts
```

**Endpoints:**
- [ ] `POST /api/upload` - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π endpoint –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
  - Multer middleware –¥–ª—è multipart/form-data
  - Query param: `type` (car-photo, visit-photo, document, logo, signature)
  - –¢–∏–ø—ã —Ñ–∞–π–ª–æ–≤:
    - images: jpg, jpeg, png (–¥–æ 10MB)
    - documents: pdf, doc, docx (–¥–æ 20MB)
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É: `/uploads/{userId}/{type}/{uuid}.{ext}`
  - –î–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: —Å–∂–∞—Ç–∏–µ —á–µ—Ä–µ–∑ sharp (max 1920x1080, quality 80%)
  - –í–æ–∑–≤—Ä–∞—Ç: `{ url: '/api/files/...' }`

- [ ] `GET /api/files/*` - —Ä–∞–∑–¥–∞—á–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
  - Express.static middleware –¥–ª—è /uploads
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è MVP, –º–æ–∂–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å)
  - Headers: Content-Type, Cache-Control

- [ ] `DELETE /api/files/:path` - —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
  - –§–∏–∑–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å –¥–∏—Å–∫–∞
  - –í–æ–∑–≤—Ä–∞—Ç `{ success: true }`

#### 5.2 –£—Ç–∏–ª–∏—Ç—ã
- [ ] `FileValidator` - –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–∞, —Ä–∞–∑–º–µ—Ä–∞, —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- [ ] `ImageProcessor` - —Å–∂–∞—Ç–∏–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [ ] `FileStorage` - —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π
- [ ] `generateUniqueFilename()` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è UUID –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤

#### 5.3 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```typescript
// config/file-upload.config.ts
export const FILE_UPLOAD_CONFIG = {
  maxFileSize: {
    image: 10 * 1024 * 1024,  // 10MB
    document: 20 * 1024 * 1024, // 20MB
  },
  allowedMimeTypes: {
    image: ['image/jpeg', 'image/png'],
    document: ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'],
  },
  uploadDir: './uploads',
  imageCompression: {
    maxWidth: 1920,
    maxHeight: 1080,
    quality: 80,
  },
};
```

---

### –§–∞–∑–∞ 6: Email —Å–µ—Ä–≤–∏—Å (1-2 —á–∞—Å–∞)

#### 6.1 Mail Module

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
src/mail/
‚îú‚îÄ‚îÄ mail.service.ts
‚îú‚îÄ‚îÄ mail.module.ts
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îú‚îÄ‚îÄ password-reset.hbs
‚îÇ   ‚îî‚îÄ‚îÄ visit-report.hbs
‚îî‚îÄ‚îÄ interfaces/
    ‚îî‚îÄ‚îÄ mail-options.interface.ts
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ @nestjs-modules/mailer –∏ nodemailer
- [ ] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SMTP —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ (Gmail, Mailgun, –∏–ª–∏ SendGrid)
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Handlebars –¥–ª—è —à–∞–±–ª–æ–Ω–æ–≤

**–§—É–Ω–∫—Ü–∏–∏:**
- [ ] `sendPasswordResetEmail(email: string, resetToken: string)`
  - –®–∞–±–ª–æ–Ω —Å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ–º, –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –∏ –∫–Ω–æ–ø–∫–æ–π
  - –°—Å—ã–ª–∫–∞: `https://app.example.com/reset-password?token={resetToken}`
  - –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è: 1 —á–∞—Å

- [ ] `sendVisitReportEmail(email: string, pdfBuffer: Buffer, visitData: any)`
  - –®–∞–±–ª–æ–Ω —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –≤–∏–∑–∏—Ç–µ
  - –ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ PDF —Ñ–∞–π–ª–∞
  - –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è —Å –¥–∞–Ω–Ω—ã–º–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—è

**–®–∞–±–ª–æ–Ω password-reset.hbs:**
```handlebars
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è</title>
</head>
<body>
  <h1>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è</h1>
  <p>–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!</p>
  <p>–í—ã –∑–∞–ø—Ä–æ—Å–∏–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è –¥–ª—è –≤–∞—à–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –≤ MechanicCompanion.</p>
  <p>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã —Å–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å:</p>
  <a href="{{resetLink}}" style="display: inline-block; padding: 10px 20px; background: #007bff; color: white; text-decoration: none; border-radius: 5px;">
    –°–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å
  </a>
  <p>–°—Å—ã–ª–∫–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 1 —á–∞—Å–∞.</p>
  <p>–ï—Å–ª–∏ –≤—ã –Ω–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è, –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä—É–π—Ç–µ —ç—Ç–æ –ø–∏—Å—å–º–æ.</p>
  <br>
  <p>–° —É–≤–∞–∂–µ–Ω–∏–µ–º,<br>–ö–æ–º–∞–Ω–¥–∞ MechanicCompanion</p>
</body>
</html>
```

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫
- [ ] Retry –º–µ—Ö–∞–Ω–∏–∑–º (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] Graceful degradation (–Ω–µ –ª–æ–º–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–ª–æ—É –ø—Ä–∏ –æ—à–∏–±–∫–µ email)

---

### –§–∞–∑–∞ 7: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF –æ—Ç—á—ë—Ç–æ–≤ (2-3 —á–∞—Å–∞)

#### 7.1 PDF Module

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
src/pdf/
‚îú‚îÄ‚îÄ pdf.service.ts
‚îú‚îÄ‚îÄ pdf.module.ts
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îú‚îÄ‚îÄ visit-report.html
‚îÇ   ‚îî‚îÄ‚îÄ styles.css
‚îî‚îÄ‚îÄ interfaces/
    ‚îî‚îÄ‚îÄ pdf-options.interface.ts
```

**Endpoints:**
- [ ] `GET /api/visits/:id/export-pdf` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –≤–æ–∑–≤—Ä–∞—Ç PDF
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF
  - –í–æ–∑–≤—Ä–∞—Ç —Ñ–∞–π–ª–∞ —Å headers:
    ```
    Content-Type: application/pdf
    Content-Disposition: attachment; filename="visit-{id}-{date}.pdf"
    ```

- [ ] `POST /api/visits/:id/send-report` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è + –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ email
  - Body: `{ email: string }`
  - –í–∞–ª–∏–¥–∞—Ü–∏—è email —Ñ–æ—Ä–º–∞—Ç–∞
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF
  - –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ Mail Service
  - –í–æ–∑–≤—Ä–∞—Ç `{ success: true, message: '–û—Ç—á—ë—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ email' }`

#### 7.2 –®–∞–±–ª–æ–Ω HTML –¥–ª—è PDF

**visit-report.html:**
```html
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–û—Ç—á—ë—Ç –æ –≤–∏–∑–∏—Ç–µ</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding: 20px;
      color: #333;
    }
    .header {
      display: flex;
      justify-content: space-between;
      border-bottom: 2px solid #007bff;
      padding-bottom: 20px;
      margin-bottom: 20px;
    }
    .logo {
      max-width: 150px;
      max-height: 80px;
    }
    .workshop-info {
      text-align: right;
    }
    h1 {
      color: #007bff;
      margin: 0;
    }
    .section {
      margin-bottom: 30px;
    }
    .section-title {
      background: #f0f0f0;
      padding: 10px;
      font-weight: bold;
      margin-bottom: 10px;
    }
    .info-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .info-item {
      padding: 5px 0;
    }
    .label {
      font-weight: bold;
      color: #666;
    }
    .checklist {
      list-style: none;
      padding: 0;
    }
    .checklist li {
      padding: 5px 0;
      border-bottom: 1px solid #eee;
    }
    .photo-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 10px;
    }
    .photo-grid img {
      width: 100%;
      height: auto;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    .materials-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    .materials-table th,
    .materials-table td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    .materials-table th {
      background: #f0f0f0;
      font-weight: bold;
    }
    .total-row {
      font-weight: bold;
      background: #f9f9f9;
    }
    .status-badge {
      display: inline-block;
      padding: 5px 10px;
      border-radius: 5px;
      font-size: 12px;
      font-weight: bold;
    }
    .status-in-progress { background: #ffc107; color: white; }
    .status-completed { background: #28a745; color: white; }
    .status-delivered { background: #007bff; color: white; }
    .status-cancelled { background: #dc3545; color: white; }
    .footer {
      margin-top: 50px;
      border-top: 1px solid #ddd;
      padding-top: 20px;
      text-align: center;
      color: #666;
      font-size: 12px;
    }
    .signature {
      max-width: 200px;
      margin: 20px auto;
    }
  </style>
</head>
<body>
  <div class="header">
    <div>
      {{#if workshopLogo}}
      <img src="{{workshopLogo}}" alt="–õ–æ–≥–æ—Ç–∏–ø" class="logo">
      {{/if}}
      <h1>{{workshopName}}</h1>
      <p>{{workshopPhone}}<br>{{workshopAddress}}</p>
    </div>
    <div class="workshop-info">
      <h2>–û–¢–ß–Å–¢ –û –í–ò–ó–ò–¢–ï</h2>
      <p>–î–∞—Ç–∞: {{reportDate}}</p>
      <p>‚Ññ {{visitId}}</p>
    </div>
  </div>

  <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–≤—Ç–æ–º–æ–±–∏–ª–µ -->
  <div class="section">
    <div class="section-title">–ò–ù–§–û–†–ú–ê–¶–ò–Ø –û–ë –ê–í–¢–û–ú–û–ë–ò–õ–ï</div>
    <div class="info-grid">
      <div class="info-item">
        <span class="label">–ú–∞—Ä–∫–∞ –∏ –º–æ–¥–µ–ª—å:</span> {{carBrand}} {{carModel}}
      </div>
      <div class="info-item">
        <span class="label">–ì–æ—Å–Ω–æ–º–µ—Ä:</span> {{carLicensePlate}}
      </div>
      <div class="info-item">
        <span class="label">VIN:</span> {{carVin}}
      </div>
      <div class="info-item">
        <span class="label">–ì–æ–¥ –≤—ã–ø—É—Å–∫–∞:</span> {{carYear}}
      </div>
      <div class="info-item">
        <span class="label">–í–ª–∞–¥–µ–ª–µ—Ü:</span> {{ownerName}}
      </div>
      <div class="info-item">
        <span class="label">–¢–µ–ª–µ—Ñ–æ–Ω:</span> {{ownerPhone}}
      </div>
    </div>
  </div>

  <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–∏–∑–∏—Ç–µ -->
  <div class="section">
    <div class="section-title">–ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –í–ò–ó–ò–¢–ï</div>
    <div class="info-grid">
      <div class="info-item">
        <span class="label">–î–∞—Ç–∞ –ø—Ä–∏—ë–º–∫–∏:</span> {{visitDate}}
      </div>
      <div class="info-item">
        <span class="label">–¢–∏–ø —Ä–∞–±–æ—Ç:</span> {{workType}}
      </div>
      <div class="info-item">
        <span class="label">–°—Ç–∞—Ç—É—Å:</span> <span class="status-badge status-{{status}}">{{statusText}}</span>
      </div>
      <div class="info-item">
        <span class="label">–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:</span> {{estimatedCompletionDate}}
      </div>
    </div>
    <div class="info-item" style="margin-top: 10px;">
      <span class="label">–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç:</span><br>
      {{workDescription}}
    </div>
  </div>

  <!-- –ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–∏—ë–º–∫–∏ -->
  <div class="section">
    <div class="section-title">–ß–ï–ö-–õ–ò–°–¢ –ü–†–ò–Å–ú–ö–ò</div>
    <ul class="checklist">
      <li><span class="label">–£—Ä–æ–≤–µ–Ω—å —Ç–æ–ø–ª–∏–≤–∞:</span> {{fuelLevel}}%</li>
      <li><span class="label">–ü—Ä–æ–±–µ–≥:</span> {{mileage}} –∫–º</li>
      <li><span class="label">–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è:</span> {{#if hasDamages}}–î–∞ - {{damagesDescription}}{{else}}–ù–µ—Ç{{/if}}</li>
      <li><span class="label">–õ–∏—á–Ω—ã–µ –≤–µ—â–∏ –≤ —Å–∞–ª–æ–Ω–µ:</span> {{personalItems}}</li>
      <li><span class="label">–°–æ—Å—Ç–æ—è–Ω–∏–µ —à–∏–Ω:</span> {{tireCondition}}</li>
    </ul>
  </div>

  <!-- –§–æ—Ç–æ –î–û -->
  {{#if beforePhotos}}
  <div class="section">
    <div class="section-title">–§–û–¢–û –î–û –†–ê–ë–û–¢</div>
    <div class="photo-grid">
      {{#each beforePhotos}}
      <img src="{{this}}" alt="–§–æ—Ç–æ –¥–æ">
      {{/each}}
    </div>
  </div>
  {{/if}}

  <!-- –§–æ—Ç–æ –ü–û–°–õ–ï -->
  {{#if afterPhotos}}
  <div class="section">
    <div class="section-title">–§–û–¢–û –ü–û–°–õ–ï –†–ê–ë–û–¢</div>
    <div class="photo-grid">
      {{#each afterPhotos}}
      <img src="{{this}}" alt="–§–æ—Ç–æ –ø–æ—Å–ª–µ">
      {{/each}}
    </div>
  </div>
  {{/if}}

  <!-- –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –∑–∞–ø—á–∞—Å—Ç–∏ -->
  {{#if materials}}
  <div class="section">
    <div class="section-title">–ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ù–´–ï –ú–ê–¢–ï–†–ò–ê–õ–´ –ò –ó–ê–ü–ß–ê–°–¢–ò</div>
    <table class="materials-table">
      <thead>
        <tr>
          <th>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ</th>
          <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
          <th>–¶–µ–Ω–∞ –∑–∞ –µ–¥.</th>
          <th>–°—É–º–º–∞</th>
        </tr>
      </thead>
      <tbody>
        {{#each materials}}
        <tr>
          <td>{{name}}</td>
          <td>{{quantity}}</td>
          <td>{{price}} ‚ÇΩ</td>
          <td>{{total}} ‚ÇΩ</td>
        </tr>
        {{/each}}
        <tr class="total-row">
          <td colspan="3">–ò—Ç–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª—ã:</td>
          <td>{{materialsTotal}} ‚ÇΩ</td>
        </tr>
      </tbody>
    </table>
  </div>
  {{/if}}

  <!-- –°—Ç–æ–∏–º–æ—Å—Ç—å -->
  <div class="section">
    <div class="section-title">–°–¢–û–ò–ú–û–°–¢–¨</div>
    <div class="info-grid">
      <div class="info-item">
        <span class="label">–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:</span> {{estimatedCost}} ‚ÇΩ
      </div>
      <div class="info-item">
        <span class="label">–ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:</span> <strong>{{finalCost}} ‚ÇΩ</strong>
      </div>
    </div>
  </div>

  <!-- –ü–æ–¥–ø–∏—Å—å -->
  <div class="footer">
    {{#if signature}}
    <img src="{{signature}}" alt="–ü–æ–¥–ø–∏—Å—å" class="signature">
    {{/if}}
    <p>–ú–∞—Å—Ç–µ—Ä: ________________</p>
    <p>–î–∞—Ç–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç—á—ë—Ç–∞: {{generatedAt}}</p>
  </div>
</body>
</html>
```

#### 7.3 Puppeteer –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```typescript
// pdf.service.ts
import puppeteer from 'puppeteer';

async generatePDF(visitData: any): Promise<Buffer> {
  const browser = await puppeteer.launch({
    headless: true,
    args: ['--no-sandbox', '--disable-setuid-sandbox'],
  });

  const page = await browser.newPage();

  // –†–µ–Ω–¥–µ—Ä–∏–º HTML –∏–∑ —à–∞–±–ª–æ–Ω–∞
  const html = this.renderTemplate(visitData);

  await page.setContent(html, {
    waitUntil: 'networkidle0',
  });

  const pdfBuffer = await page.pdf({
    format: 'A4',
    printBackground: true,
    margin: {
      top: '20mm',
      right: '15mm',
      bottom: '20mm',
      left: '15mm',
    },
  });

  await browser.close();

  return pdfBuffer;
}
```

---

### –§–∞–∑–∞ 8: –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (1 —á–∞—Å)

#### 8.1 Profile Module

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
src/profile/
‚îú‚îÄ‚îÄ profile.controller.ts
‚îú‚îÄ‚îÄ profile.service.ts
‚îú‚îÄ‚îÄ profile.module.ts
‚îî‚îÄ‚îÄ dto/
    ‚îú‚îÄ‚îÄ update-profile.dto.ts
    ‚îî‚îÄ‚îÄ change-password.dto.ts
```

**Endpoints:**
- [ ] `GET /api/profile` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
  - –í–æ–∑–≤—Ä–∞—Ç User –±–µ–∑ password –∏ refreshTokens

- [ ] `PUT /api/profile` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
  - –û–±–Ω–æ–≤–ª—è–µ–º—ã–µ –ø–æ–ª—è: workshopName, phone, address
  - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (—Ä–æ—Å—Å–∏–π—Å–∫–∏–π —Ñ–æ—Ä–º–∞—Ç)
  - –í–æ–∑–≤—Ä–∞—Ç –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è

- [ ] `PUT /api/profile/password` - —Å–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è
  - Body: `{ oldPassword, newPassword }`
  - –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç–∞—Ä–æ–≥–æ –ø–∞—Ä–æ–ª—è
  - –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–∞—Ä–æ–ª—è
  - –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö refresh tokens (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  - –í–æ–∑–≤—Ä–∞—Ç `{ success: true }`

- [ ] `POST /api/profile/logo` - –∑–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ—Ç–∏–ø–∞
  - Multipart upload
  - –°–∂–∞—Ç–∏–µ –¥–æ 400x400
  - –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –ª–æ–≥–æ—Ç–∏–ø–∞
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ logoUrl
  - –í–æ–∑–≤—Ä–∞—Ç `{ logoUrl }`

- [ ] `POST /api/profile/signature` - –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ–¥–ø–∏—Å–∏
  - Multipart upload
  - –ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π PNG
  - –°–∂–∞—Ç–∏–µ –¥–æ 300x100
  - –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–π –ø–æ–¥–ø–∏—Å–∏
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ signatureUrl
  - –í–æ–∑–≤—Ä–∞—Ç `{ signatureUrl }`

---

### –§–∞–∑–∞ 9: –§–∏–Ω–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (2-3 —á–∞—Å–∞)

#### 9.1 –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

**Security:**
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Helmet
  ```typescript
  app.use(helmet());
  ```

- [ ] Rate limiting (@nestjs/throttler)
  ```typescript
  // app.module.ts
  ThrottlerModule.forRoot({
    ttl: 60,
    limit: 100, // 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
  }),

  // auth.controller.ts
  @Throttle(5, 60) // 5 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É –¥–ª—è auth endpoints
  ```

- [ ] CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
  ```typescript
  app.enableCors({
    origin: process.env.CORS_ORIGIN || '*',
    credentials: true,
  });
  ```

**Optimization:**
- [ ] Compression middleware
  ```typescript
  import * as compression from 'compression';
  app.use(compression());
  ```

- [ ] Request logging (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ - Pino)

- [ ] –ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
  ```typescript
  app.useGlobalFilters(new HttpExceptionFilter());
  ```

- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö DTO
  ```typescript
  app.useGlobalPipes(new ValidationPipe({
    whitelist: true,
    transform: true,
    forbidNonWhitelisted: true,
  }));
  ```

- [ ] Transform Interceptor –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤
  ```typescript
  app.useGlobalInterceptors(new TransformInterceptor());
  ```

**Database optimization:**
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ Prisma schema
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–ª—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- [ ] Connection pooling –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

#### 9.2 –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

**Swagger/OpenAPI:**
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ @nestjs/swagger
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ main.ts
  ```typescript
  const config = new DocumentBuilder()
    .setTitle('MechanicCompanion API')
    .setDescription('API –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–æ–º')
    .setVersion('1.0')
    .addBearerAuth()
    .build();
  const document = SwaggerModule.createDocument(app, config);
  SwaggerModule.setup('api/docs', app, document);
  ```

- [ ] –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã @ApiTags, @ApiOperation, @ApiResponse –¥–ª—è –≤—Å–µ—Ö endpoints
- [ ] –û–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö DTO —Å @ApiProperty
- [ ] –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤

**README.md:**
```markdown
# MechanicCompanion Backend

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env
cp .env.example .env

# –ó–∞–ø—É—Å–∫ PostgreSQL (–µ—Å–ª–∏ –±–µ–∑ Docker)
# –∏–ª–∏ docker-compose up -d postgres

# –ú–∏–≥—Ä–∞—Ü–∏–∏
npx prisma migrate dev

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
npm run start:dev
```

### Docker
```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up --build

# –¢–æ–ª—å–∫–æ backend
docker-compose up app
```

## API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:3000/api/docs

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–º. `.env.example`

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
...
```

#### 9.3 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Postman/Insomnia):**
- [ ] Auth flow:
  - [ ] –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - [ ] –õ–æ–≥–∏–Ω
  - [ ] Refresh token
  - [ ] Forgot password
  - [ ] Reset password

- [ ] Cars CRUD:
  - [ ] –°–æ–∑–¥–∞–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è
  - [ ] –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞
  - [ ] –ü–æ–∏—Å–∫ –ø–æ –≥–æ—Å–Ω–æ–º–µ—Ä—É
  - [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
  - [ ] –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ
  - [ ] –£–¥–∞–ª–µ–Ω–∏–µ

- [ ] Visits CRUD:
  - [ ] –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑–∏—Ç–∞
  - [ ] –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞
  - [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
  - [ ] –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
  - [ ] –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ
  - [ ] –£–¥–∞–ª–µ–Ω–∏–µ

- [ ] PDF –∏ Email:
  - [ ] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF –æ—Ç—á—ë—Ç–∞
  - [ ] –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á—ë—Ç–∞ –Ω–∞ email

- [ ] Profile:
  - [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
  - [ ] –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è
  - [ ] –ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ—Ç–∏–ø–∞

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
- [ ] –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —á—É–∂–∏–º –¥–∞–Ω–Ω—ã–º (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 403)
- [ ] –ó–∞–ø—Ä–æ—Å—ã –±–µ–∑ —Ç–æ–∫–µ–Ω–∞ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 401)
- [ ] –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏)
- [ ] Rate limiting (—Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤)

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ Docker:**
- [ ] –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞ –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- [ ] –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API
- [ ] –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å PostgreSQL
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –≤ volume

**Load testing (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
```bash
# Apache Bench
ab -n 1000 -c 10 http://localhost:3000/api/cars
```

#### 9.4 –§–∏–Ω–∞–ª—å–Ω—ã–µ —à—Ç—Ä–∏—Ö–∏
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ health check endpoint
  ```typescript
  @Get('health')
  healthCheck() {
    return { status: 'ok', timestamp: new Date().toISOString() };
  }
  ```

- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–∂–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è, —É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö)
- [ ] Graceful shutdown
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .gitignore (node_modules, .env, uploads/, dist/)
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ .env.example —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏

---

## –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê

```
MechanicCompanionBackend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ auth/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.controller.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.module.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dto/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ register.dto.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login.dto.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ refresh-token.dto.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ forgot-password.dto.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ reset-password.dto.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ guards/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ jwt-auth.guard.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ jwt-refresh.guard.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ strategies/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ jwt.strategy.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ jwt-refresh.strategy.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ decorators/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ current-user.decorator.ts
‚îÇ   ‚îú‚îÄ‚îÄ cars/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cars.controller.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cars.service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cars.module.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dto/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ create-car.dto.ts
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ update-car.dto.ts
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ query-cars.dto.ts
‚îÇ   ‚îú‚îÄ‚îÄ visits/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ visits.controller.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ visits.service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ visits.module.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dto/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ create-visit.dto.ts
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ update-visit.dto.ts
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ update-status.dto.ts
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ query-visits.dto.ts
‚îÇ   ‚îú‚îÄ‚îÄ materials/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ materials.controller.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ materials.service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ materials.module.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dto/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ create-material.dto.ts
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ update-material.dto.ts
‚îÇ   ‚îú‚îÄ‚îÄ documents/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ documents.controller.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ documents.service.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ documents.module.ts
‚îÇ   ‚îú‚îÄ‚îÄ files/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ files.controller.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ files.service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ files.module.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ interceptors/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ file-upload.interceptor.ts
‚îÇ   ‚îú‚îÄ‚îÄ mail/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mail.service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mail.module.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ password-reset.hbs
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ visit-report.hbs
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ interfaces/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ mail-options.interface.ts
‚îÇ   ‚îú‚îÄ‚îÄ pdf/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pdf.service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pdf.module.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ visit-report.html
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ styles.css
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ interfaces/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ pdf-options.interface.ts
‚îÇ   ‚îú‚îÄ‚îÄ profile/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ profile.controller.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ profile.service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ profile.module.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dto/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ update-profile.dto.ts
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ change-password.dto.ts
‚îÇ   ‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prisma.service.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ prisma.module.ts
‚îÇ   ‚îú‚îÄ‚îÄ common/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ filters/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ http-exception.filter.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ interceptors/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ transform.interceptor.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pipes/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ validation.pipe.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ decorators/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ api-response.decorator.ts
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ configuration.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ file-upload.config.ts
‚îÇ   ‚îú‚îÄ‚îÄ app.module.ts
‚îÇ   ‚îî‚îÄ‚îÄ main.ts
‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îú‚îÄ‚îÄ schema.prisma
‚îÇ   ‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îî‚îÄ‚îÄ seed.ts
‚îú‚îÄ‚îÄ uploads/              # Volume –¥–ª—è —Ñ–∞–π–ª–æ–≤ (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è)
‚îú‚îÄ‚îÄ tmp/                  # –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ test/
‚îÇ   ‚îú‚îÄ‚îÄ app.e2e-spec.ts
‚îÇ   ‚îî‚îÄ‚îÄ jest-e2e.json
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ .env                  # –ù–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è
‚îú‚îÄ‚îÄ .dockerignore
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ tsconfig.json
‚îú‚îÄ‚îÄ nest-cli.json
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ BACKEND_PLAN.md      # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

---

## –ü–ï–†–ï–ú–ï–ù–ù–´–ï –û–ö–†–£–ñ–ï–ù–ò–Ø

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`:

```env
# App
NODE_ENV=development
PORT=3000
API_PREFIX=api

# Database
DATABASE_URL=postgresql://postgres:password@localhost:5432/mechanic_companion

# JWT
JWT_SECRET=your-super-secret-jwt-key-change-in-production-min-32-chars
JWT_EXPIRES_IN=1h
JWT_REFRESH_SECRET=your-super-secret-refresh-key-change-in-production
JWT_REFRESH_EXPIRES_IN=7d

# Email (SMTP)
# –î–ª—è Gmail: –≤–∫–ª—é—á–∏—Ç—å 2FA –∏ —Å–æ–∑–¥–∞—Ç—å App Password
MAIL_HOST=smtp.gmail.com
MAIL_PORT=587
MAIL_USER=your-email@gmail.com
MAIL_PASSWORD=your-app-password
MAIL_FROM=MechanicCompanion <noreply@mechaniccompanion.com>

# Files
UPLOAD_DIR=./uploads
MAX_IMAGE_SIZE=10485760    # 10MB –≤ –±–∞–π—Ç–∞—Ö
MAX_DOCUMENT_SIZE=20971520 # 20MB –≤ –±–∞–π—Ç–∞—Ö

# PDF
PDF_TEMP_DIR=./tmp/pdf

# CORS
CORS_ORIGIN=*  # –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —É–∫–∞–∑–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–æ–º–µ–Ω—ã

# Rate Limiting
THROTTLE_TTL=60           # –≤—Ä–µ–º—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
THROTTLE_LIMIT=100        # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
THROTTLE_AUTH_LIMIT=5     # –ª–∏–º–∏—Ç –¥–ª—è auth endpoints

# App URL (–¥–ª—è email —Å—Å—ã–ª–æ–∫)
APP_URL=http://localhost:3000
FRONTEND_URL=http://localhost:8081  # React Native Metro bundler
```

---

## DOCKER –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø

### docker-compose.yml
```yaml
version: '3.8'

services:
  postgres:
    image: postgres:16-alpine
    container_name: mechanic_companion_db
    restart: unless-stopped
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
      POSTGRES_DB: mechanic_companion
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U postgres"]
      interval: 10s
      timeout: 5s
      retries: 5
    networks:
      - app-network

  app:
    build:
      context: .
      dockerfile: Dockerfile
      target: production
    container_name: mechanic_companion_backend
    restart: unless-stopped
    ports:
      - "3000:3000"
    environment:
      NODE_ENV: production
      DATABASE_URL: postgresql://postgres:password@postgres:5432/mechanic_companion
      PORT: 3000
    env_file:
      - .env
    volumes:
      - ./uploads:/app/uploads
      - ./tmp:/app/tmp
    depends_on:
      postgres:
        condition: service_healthy
    command: sh -c "npx prisma migrate deploy && npm run start:prod"
    networks:
      - app-network

volumes:
  postgres_data:

networks:
  app-network:
    driver: bridge
```

### Dockerfile
```dockerfile
# Stage 1: Build
FROM node:20-alpine AS builder

WORKDIR /app

COPY package*.json ./
COPY prisma ./prisma/

RUN npm ci

COPY . .

RUN npx prisma generate
RUN npm run build

# Stage 2: Production
FROM node:20-alpine AS production

WORKDIR /app

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Puppeteer dependencies
RUN apk add --no-cache \
    chromium \
    nss \
    freetype \
    harfbuzz \
    ca-certificates \
    ttf-freefont

ENV PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=true
ENV PUPPETEER_EXECUTABLE_PATH=/usr/bin/chromium-browser

COPY package*.json ./
COPY prisma ./prisma/

RUN npm ci --only=production

COPY --from=builder /app/dist ./dist
COPY --from=builder /app/node_modules/.prisma ./node_modules/.prisma

RUN mkdir -p uploads tmp/pdf && chmod -R 777 uploads tmp

EXPOSE 3000

CMD ["node", "dist/main"]
```

### .dockerignore
```
node_modules
dist
.env
.git
.gitignore
README.md
uploads
tmp
*.log
.DS_Store
```

---

## –û–¶–ï–ù–ö–ê –í–†–ï–ú–ï–ù–ò

| –§–∞–∑–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –í—Ä–µ–º—è |
|------|----------|-------|
| 1 | –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ | 2-3 —á–∞—Å–∞ |
| 2 | –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | 3-4 —á–∞—Å–∞ |
| 3 | –ú–æ–¥—É–ª—å –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π | 2-3 —á–∞—Å–∞ |
| 4 | –ú–æ–¥—É–ª—å –≤–∏–∑–∏—Ç–æ–≤ | 3-4 —á–∞—Å–∞ |
| 5 | –§–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ | 1-2 —á–∞—Å–∞ |
| 6 | Email —Å–µ—Ä–≤–∏—Å | 1-2 —á–∞—Å–∞ |
| 7 | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF | 2-3 —á–∞—Å–∞ |
| 8 | –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | 1 —á–∞—Å |
| 9 | –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 2-3 —á–∞—Å–∞ |
| **–ò–¢–û–ì–û** | **17-25 —á–∞—Å–æ–≤** | **2-3 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è** |

---

## –ü–†–ò–û–†–ò–¢–ï–¢–´ –î–õ–Ø MVP

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (Must Have):
1. ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –ª–æ–≥–∏–Ω, refresh token)
2. ‚úÖ CRUD –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π
3. ‚úÖ CRUD –≤–∏–∑–∏—Ç–æ–≤
4. ‚úÖ –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –≤–∏–∑–∏—Ç–æ–≤
5. ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ (—Ñ–æ—Ç–æ, –¥–æ–∫—É–º–µ–Ω—Ç—ã)
6. ‚úÖ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

### –í–∞–∂–Ω—ã–µ (Should Have):
7. ‚úÖ Email (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è)
8. ‚úÖ PDF –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
9. ‚úÖ –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
10. ‚úÖ Rate limiting

### –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ (Nice to Have):
11. ‚≠ï Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
12. ‚≠ï –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (Winston/Pino)
13. ‚≠ï Unit —Ç–µ—Å—Ç—ã
14. ‚≠ï E2E —Ç–µ—Å—Ç—ã

---

## –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –±–∞–∑–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ –±—ç–∫–µ–Ω–¥–∞:

1. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º**
   - –ò–∑–º–µ–Ω–∏—Ç—å `USE_MOCKS = false` –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
   - –û–±–Ω–æ–≤–∏—Ç—å `API_URL` –Ω–∞ –∞–¥—Ä–µ—Å –±—ç–∫–µ–Ω–¥–∞
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

2. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∏—á–∏**
   - Push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (Firebase Cloud Messaging)
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
   - –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö (CSV, Excel)
   - Backup –∏ restore

3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**
   - –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (Redis)
   - CDN –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
   - Database query optimization
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Prometheus, Grafana)

4. **–î–µ–ø–ª–æ–π**
   - –í—ã–±–æ—Ä —Ö–æ—Å—Ç–∏–Ω–≥–∞ (AWS, DigitalOcean, Railway, Render)
   - CI/CD –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (GitHub Actions)
   - SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
   - Domain –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

---

## –ü–û–õ–ï–ó–ù–´–ï –ö–û–ú–ê–ù–î–´

```bash
# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
npm run start:dev         # –ó–∞–ø—É—Å–∫ –≤ dev —Ä–µ–∂–∏–º–µ —Å hot-reload
npm run build             # –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
npm run start:prod        # –ó–∞–ø—É—Å–∫ production –≤–µ—Ä—Å–∏–∏

# Prisma
npx prisma studio         # –û—Ç–∫—Ä—ã—Ç—å Prisma Studio (GUI –¥–ª—è –ë–î)
npx prisma migrate dev    # –°–æ–∑–¥–∞—Ç—å –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
npx prisma migrate deploy # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ (production)
npx prisma generate       # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Prisma Client
npx prisma db seed        # –ó–∞–ø—É—Å—Ç–∏—Ç—å seed

# Docker
docker-compose up         # –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose up -d      # –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
docker-compose down       # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose logs -f    # –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose exec app sh # –í–æ–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä app

# Database
docker-compose exec postgres psql -U postgres -d mechanic_companion # –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ PostgreSQL
```

---

## –ö–û–ù–¢–†–û–õ–¨–ù–´–ô –°–ü–ò–°–û–ö (CHECKLIST)

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç checklist –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:

### –§–∞–∑–∞ 1: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ ‚úÖ (–ó–ê–í–ï–†–®–ï–ù–ê 04.02.2026)
- [x] NestJS –ø—Ä–æ–µ–∫—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
- [x] –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã (Prisma 6.19.2, NestJS 11, –≤—Å—ë –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ)
- [x] Prisma –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Å—Ö–µ–º–∞ —Å–æ–∑–¥–∞–Ω–∞ (–ø–æ–ª–Ω–∞—è —Å—Ö–µ–º–∞ –ë–î —Å 11 –º–æ–¥–µ–ª—è–º–∏)
- [x] Prisma Client —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω
- [x] Docker –∏ docker-compose —Å–æ–∑–¥–∞–Ω—ã (–≥–æ—Ç–æ–≤—ã –∫ –∑–∞–ø—É—Å–∫—É)
- [x] .env –Ω–∞—Å—Ç—Ä–æ–µ–Ω (.env –∏ .env.example —Å–æ–∑–¥–∞–Ω—ã)
- [x] PrismaModule –∏ PrismaService —Å–æ–∑–¥–∞–Ω—ã
- [x] –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- [x] TypeScript, ESLint, Prettier –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [x] .gitignore –∏ .dockerignore –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ú–∏–≥—Ä–∞—Ü–∏–∏ –±—É–¥—É—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ —Å –ë–î –∫–æ–º–∞–Ω–¥–æ–π `npx prisma migrate dev --name init`

### –§–∞–∑–∞ 2: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è ‚úÖ (–ó–ê–í–ï–†–®–ï–ù–ê 04.02.2026)
- [x] Auth module —Å–æ–∑–¥–∞–Ω (dto, guards, strategies, decorators)
- [x] Register endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç (—Å bcrypt —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º)
- [x] Login endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç (—Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π credentials)
- [x] Refresh token —Ä–∞–±–æ—Ç–∞–µ—Ç (—Å rotation –º–µ—Ö–∞–Ω–∏–∑–º–æ–º)
- [x] JWT guards –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã (JwtAuthGuard, JwtRefreshGuard)
- [x] Forgot/reset password —Ä–∞–±–æ—Ç–∞—é—Ç (—Å —Ç–æ–∫–µ–Ω–æ–º –Ω–∞ 1 —á–∞—Å)
- [x] –î–µ–∫–æ—Ä–∞—Ç–æ—Ä @CurrentUser —Å–æ–∑–¥–∞–Ω
- [x] HttpExceptionFilter –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- [x] TransformInterceptor –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤
- [x] Rate limiting –Ω–∞—Å—Ç—Ä–æ–µ–Ω (5/–º–∏–Ω –¥–ª—è auth endpoints)
- [x] –í—Å–µ endpoints –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã

### –§–∞–∑–∞ 3: –ê–≤—Ç–æ–º–æ–±–∏–ª–∏ ‚¨ú
- [ ] Cars CRUD endpoints —Å–æ–∑–¥–∞–Ω—ã
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ü–æ–∏—Å–∫ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –î–æ–∫—É–º–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç

### –§–∞–∑–∞ 4: –í–∏–∑–∏—Ç—ã ‚¨ú
- [ ] Visits CRUD endpoints —Å–æ–∑–¥–∞–Ω—ã
- [ ] Materials CRUD —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–æ–≤ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –î–æ–∫—É–º–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç

### –§–∞–∑–∞ 5: –§–∞–π–ª—ã ‚¨ú
- [ ] Upload endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –°–∂–∞—Ç–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –†–∞–∑–¥–∞—á–∞ —Ñ–∞–π–ª–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –§–∞–∑–∞ 6: Email ‚¨ú
- [ ] SMTP –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] Password reset email —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Visit report email —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –®–∞–±–ª–æ–Ω—ã –∫—Ä–∞—Å–∏–≤—ã–µ

### –§–∞–∑–∞ 7: PDF ‚¨ú
- [ ] PDF generation —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –®–∞–±–ª–æ–Ω –∫—Ä–∞—Å–∏–≤—ã–π
- [ ] –§–æ—Ç–æ –≤—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è
- [ ] Send report endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç

### –§–∞–∑–∞ 8: –ü—Ä–æ—Ñ–∏–ª—å ‚¨ú
- [ ] Profile endpoints —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] Change password —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Logo/signature upload —Ä–∞–±–æ—Ç–∞—é—Ç

### –§–∞–∑–∞ 9: –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è ‚¨ú
- [ ] Security –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ (Helmet, CORS, Rate limiting)
- [ ] Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [ ] README –Ω–∞–ø–∏—Å–∞–Ω
- [ ] –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–π–¥–µ–Ω–æ
- [ ] Docker —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–π–¥–µ–Ω–æ

---

## –ö–û–ù–¢–ê–ö–¢–´ –ò –†–ï–°–£–†–°–´

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [NestJS Docs](https://docs.nestjs.com/)
- [Prisma Docs](https://www.prisma.io/docs)
- [Puppeteer Docs](https://pptr.dev/)

**–ö–ª–∏–µ–Ω—Ç—Å–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
- –ü—É—Ç—å: `/Users/akozlov/projects/MechanicCompanion`
- README: –°–º. DEVELOPMENT_PLAN.md –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –ø—Ä–æ–µ–∫—Ç–µ

---

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2025-02-02*
